# DatabaseSystems

---

## Задание 4: Знакомство с СУБД RDF. БД - 4store

---

#### История создания и развития СУБД:
База данных 4store была разработана в 2007 году командой ученых из Королевского технологического института в Швеции. Изначально 4store была представлена как проект по исследованию распределенных хранилищ RDF-данных. Затем, благодаря своей высокой производительности и масштабируемости, 4store стала популярным выбором для хранения и обработки RDF-данных в различных приложениях.

Первая версия 4store была выпущена в 2008 году. Впоследствии база данных прошла несколько обновлений, в которых были добавлены новые функциональные возможности и улучшена производительность. В 2011 году 4store стала одной из первых баз данных, которая поддерживала стандарт SPARQL 1.1, что дало ей дополнительный толчок в развитии и увеличило число ее пользователей.

С 2015 года разработка 4store была приостановлена, однако база данных все еще широко используется в различных проектах и остается одним из наиболее популярных инструментов для хранения и обработки RDF-данных. Исходный код 4store до сих пор доступен в открытом доступе на GitHub, а сообщество пользователей продолжает поддерживать базу данных и создавать различные расширения и инструменты для работы с ней.

#### Инструменты для взаимодействия с СУБД
Для взаимодействия с СУБД RDF используются различные инструменты, которые позволяют работать с данными в формате RDF. Некоторые из них:

1. SPARQL (SPARQL Protocol and RDF Query Language) - это язык запросов, разработанный специально для работы с данными RDF. SPARQL позволяет выполнять запросы к СУБД RDF и извлекать информацию в соответствии с заданными критериями.

2. Apache Jena - это набор инструментов и библиотек для работы с данными RDF и выполнения запросов SPARQL. Apache Jena включает в себя инструменты для загрузки, хранения и обработки данных RDF, а также для выполнения запросов SPARQL.

3. RDFLib - это библиотека на языке Python для работы с данными RDF. Она позволяет загружать, создавать, изменять и сохранять данные RDF, а также выполнять запросы SPARQL.

4. Virtuoso - это СУБД, которая поддерживает хранение и обработку данных в формате RDF. Virtuoso также включает в себя инструменты для выполнения запросов SPARQL и интеграцию с другими базами данных.

5. Protege - это инструмент для создания онтологий и работе с данными RDF. Protege позволяет создавать онтологии и загружать данные RDF в них, а также выполнять запросы SPARQL и визуализировать данные в различных форматах.

Это только небольшой список инструментов, которые могут использоваться для работы с данными RDF и выполнения запросов SPARQL. Существует множество других инструментов и библиотек, которые могут быть полезны в работе с данными RDF.

#### Database engine используемый в СУБД

На момент первоначального проектирования было неэкономично приобретать компьютеры с достаточным объемом оперативной памяти для хранения соответствующей доли индекса RDF для прогнозируемого объема данных. Было подсчитано, что разумный средний объем памяти для четырехъядерного устройства составляет около 100 байт, что означает, что для хранения полного индекса потребуется 93 ГБ оперативной памяти. В результате было решено использовать методологию кластерного хранения.

По соображениям экономической эффективности было решено основать кластер на 64-разрядном многоядерном оборудовании x86, работающем под управлением операционной системы Linux. В то время считалось, что это обеспечивает наилучшее соотношение цены и производительности и обеспечивает доступ к большому количеству квалифицированных администраторов и системных программистов. Связь должна была обеспечиваться контроллерами и коммутаторами сетевого интерфейса Gigabit Ethernet.

#### Как устроен язык запросов в вашей СУБД RDF? Разверните БД 4store с данными и выполните ряд запросов.  (нужен пошаговые примеры кода)
Язык запросов для работы с данными RDF называется SPARQL (SPARQL Protocol and RDF Query Language). SPARQL позволяет выполнять запросы к данным RDF и извлекать информацию в соответствии с заданными критериями. Рассмотрим пример выполнения запросов SPARQL к БД 4store с данными.

Шаг 1: Установка БД 4store и загрузка данных

Перед выполнением запросов необходимо установить 4store и загрузить в него данные RDF. Процесс установки и загрузки данных зависит от операционной системы и может отличаться для разных версий 4store. Например, для Ubuntu Linux установка может быть выполнена следующим образом:

```sudo apt-get install 4store```

Затем можно загрузить данные RDF в БД с помощью утилиты `4s-import`. Предположим, что данные RDF находятся в файле `data.rdf`. Тогда можно выполнить следующую команду:

```4s-import default data.rdf```

Шаг 2: Запросы SPARQL к БД 4store

После загрузки данных можно выполнить запросы SPARQL к БД 4store. Рассмотрим несколько примеров запросов SPARQL:

Пример 1: Выборка всех субъектов, у которых есть свойство `rdf:type` с значением `foaf:Person`

`SPARQL`
```PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>

SELECT ?s
WHERE {
  ?s rdf:type foaf:Person .
}
```

Пример 2: Выборка имен и фамилий всех людей, у которых есть свойство `foaf:knows` с другим человеком

`SPARQL`
```PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>

SELECT ?firstName ?lastName
WHERE {
  ?person rdf:type foaf:Person .
  ?person foaf:knows ?friend .
  ?person foaf:firstName ?firstName .
  ?person foaf:lastName ?lastName .
}```

Пример 3: Выборка всех субъектов, у которых есть свойство `foaf:name` или `foaf:nick`

`SPARQL`
```PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX foaf: <http://xmlns.com/foaf/0.1/>

SELECT ?s
WHERE {
  ?s rdf:type foaf:Person .
  ?s foaf:name ?name .
  FILTER(lang(?name) = "en") .
  OPTIONAL {
    ?s foaf:nick ?nick .
    FILTER(lang(?nick) = "en") .
  }
}```

Шаг 3: Выполнение запросов и просмотр результатов

Для выполнения запросов SPARQL к БД 4store можно воспользоваться командной строкой или интерфейсом веб-браузера.

Для выполнения запросов через командную строку можно воспользоваться утилитой `4s-query`:

```4s-query default "SELECT ?s WHERE {?s ?p ?o}"```

Результаты запроса будут выведены в стандартный вывод.

Для выполнения запросов через веб-браузер можно использовать встроенный в 4store веб-интерфейс. Для этого нужно запустить веб-сервер 4store и перейти по адресу `http://localhost:8000/`. В веб-интерфейсе можно вводить SPARQL-запросы в поле "Query" и нажимать кнопку "Submit" для выполнения запроса. Результаты будут отображаться в виде таблицы.

В качестве альтернативы можно использовать специализированные клиенты для работы с данными RDF, такие как RDF4J или Apache Jena.

Важно отметить, что выполнение запросов SPARQL может быть затратным по ресурсам, особенно для больших наборов данных. Поэтому для улучшения производительности может потребоваться оптимизация запросов и использование индексов в БД.

#### Распределение файлов БД
4store’s cluster topology:
![distr](distr.png)
Данные разделены на несколько сегментов (неперекрывающиеся фрагменты данных), с одним или несколькими сегментами на каждом узле хранения, как показано на рисунке. Эти узлы делятся на узлы обработки и хранения.
Также возможно запустить 4 хранилища на одном узле, запустив интерфейс обработки и один или несколько внутренних интерфейсов хранилища на одной машине. 4 хранилище получает мало преимуществ от близости, и по-прежнему возникают накладные расходы на TCP-связь между компонентами обработки и хранения.

СУБД написана практически полностью на си, не считая фронтенд инструменты которые написаны на html

4 store использует анализатор Rasqal SPARQL. Rasqal создает дерево синтаксического анализа, представляющее базовую структуру выражения SPARQL. 4store обходит это дерево в поисках вхождений переменных, которые он записывает как метаданные, и помечает блоки шаблонов привязки идентификаторами.

Было обнаружено, что явные транзакции не являются необходимыми, поэтому это требование было снято

4store является open-source и поддерживается в гитхабе непосредственными создателями этой СУБД на их [гитхабе](https://github.com/4store/4store)
Права на коммит имеет группа энтузиастов из 24 человек

Найти документацию и быть в курсе происходящего можно также в том же [гитхабе](https://github.com/4store/4store) проекта.


